{"version":3,"sources":["artwells:accounts-guest/accounts-guest.js","artwells:accounts-guest/accounts-guest-server.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAAA,mB;AACA,kD;AACA,yF;AACA,C;AACA,mD;AACA,gF;AACA,C;;;;;;;;;;;;;;;;;;;ACNA,8C;AACA,wC;AACA,4B;AACA,+C;AACA,K;AACA,kF;AACA,0D;AACA,e;AACA,E;;AAEA,qD;AACA,uG;AACA,E;AACA,gB;AACA,iC;AACA,K;AACA,2D;AACA,Q;AACA,wD;AACA,6C;AACA,wB;AACA,S;;AAEA,qD;AACA,2C;;AAEA,qB;AACA,+C;AACA,S;;AAEA,iB;AACA,gC;AACA,yB;AACA,mC;AACA,oC;AACA,U;AACA,mC;AACA,qD;AACA,qB;AACA,K;AACA,G","file":"/packages/artwells_accounts-guest.js","sourcesContent":["AccountsGuest = {};\nif (typeof AccountsGuest.forced === \"undefined\") {\n\tAccountsGuest.forced = true; /*default to making loginVisitor automatic, and on logout*/\n}\nif (typeof AccountsGuest.enabled === \"undefined\") {\n\tAccountsGuest.enabled = true; /* on 'false'  Meteor.loginVisitor() will fail */\n}\n","Accounts.removeOldGuests = function (before) {\n    if (typeof before === 'undefined') {\n        before = new Date();\n        before.setHours(before.getHours() - 1);\n    }\n    res = Meteor.users.remove({createdAt: {$lte: before}, 'profile.guest': true});\n    //res = Meteor.users.remove( {'profile.guest': true});\n    return res;\n};\n\n/* adapted from pull-request https://github.com/dcsan\n* See https://github.com/artwells/meteor-accounts-guest/commit/28cbbf0eca2d80f78925ac619abf53d0769c0d9d\n*/\nMeteor.methods({\n    createGuest: function (email)\n    {\n        check(email, Match.OneOf(String, null, undefined));\n        \n        /* if explicitly disabled, happily do nothing */\n        if (AccountsGuest.enabled === false){\n            return true;\n        }\n\n        //    count = Meteor.users.find().count() + 1\n        guestname = \"guest-#\" + Random.id()\n\n        if (!email) {\n            email = guestname + \"@example.com\";\n        }\n\n        guest = {\n            username: guestname,\n            email: email,\n            profile: {guest: true},\n            password: Meteor.uuid(),\n        };\n        Accounts.createUser(guest);\n        //    console.log(\"createGuest\" + guestname);\n        return guest;\n    }\n});\n"]}